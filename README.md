# README

## アプリケーション名

DB 入門サイト

## アプリケーション概要

データベース初心者を対象に、データベースの基礎知識を体系的にアウトプットするためのブログアプリです。

## 課題

自身がデータベースの基礎知識を学習する際は、体系的に学習できる教材がなかなか見つからず、複数の参考書やネット上から情報を収集し、それらを整理することに苦労した経験がありました。

例えば、SQL、論理設計、物理設計の基礎をそれぞれ別の参考書やネット上から学習する必要があったり、インデックスなど分野を跨るような知識を十分に理解するためには、それらに関する情報を深掘りする必要があったなどです。

そのため、自身の学習した内容を元に、データベースの基礎知識を体系的に学習できる Web サイトを作成したいと考え、当サイトを作成しました。

## URL

https://beginners-db.com

## テスト用アカウント

email：visiter@example.com

password：visiter

上記アカウントでログインすると、各リソースの編集ページにアクセスすることができるようになります。

※セキュリティのため、実際のデータを編集する機能(作成、更新、削除)は制限させていただいております。

## 使用技術

- Ruby 2.7.6
- Ruby on Rails 6.0.5
- PostgreSQL 14.4
- Nginx 1.18.0
- Puma 4.3.12
- AWS
  - EC2
  - RDS
  - S3
- RSpec
- RuboCop
- ESLint
- Docker 20.10.17
- docker-compose 2.4.1
- CircleCI 2.1

## 機能一覧

- ログイン機能(devise)

  ![ログイン機能](https://user-images.githubusercontent.com/96732339/186200857-3505b0f7-0bb5-453c-8209-5c5a991c6340.gif)

- カテゴリー編集機能

  - 表示、作成、更新、削除

  ![カテゴリー編集機能](https://user-images.githubusercontent.com/96732339/186284173-b90ae9e9-f4ea-4b2f-a902-a0ac666327cc.gif)

- 記事編集機能

  - 表示、投稿、更新、削除
  - 記事の非公開設定
  - マークダウンで記述(EasyMDE + Redcarpet + CodeRay)
  - エディタにドラッグアンドドロップで画像を投稿(inline-attachment)
  - マークダウンのプレビュー

  ![記事編集機能](https://user-images.githubusercontent.com/96732339/186284189-7445acb5-7405-41fe-b66f-dfb32f582fac.gif)

- 画像リソース編集機能

  - 一覧表示、投稿、削除

  ![画像リソース編集機能](https://user-images.githubusercontent.com/96732339/186284204-eaaf6c12-97e9-44d3-8a6b-e803d2d2282f.gif)

- リンク

  - パンくずリスト
  - 目次
  - ページネーション(kaminari)
  - ページング

- 検索機能(ransack)

  | 機能名       | 使用例               | 説明                                                                                                                                                  |
  | ------------ | -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
  | 通常検索     | keyword              | キーワードが含まれていればヒットします                                                                                                                |
  | AND 検索     | keyword1 keyword2    | キーワードをスペースで区切ります<br>すべてのキーワードが含まれていればヒットします                                                                    |
  | OR 検索      | keyword1 OR keyword2 | キーワードを OR または or で区切ります<br>どちらか一方のキーワードが含まれていればヒットします                                                        |
  | 除外検索     | -keyword             | キーワードの先頭に-を付けます<br>キーワードが含まれていなければヒットします                                                                           |
  | フレーズ検索 | "sample keyword"     | キーワードをダブルクォートで囲みます<br>キーワードにスペースを含めて検索できます<br>除外検索と組み合わせる場合は、-"sample keyword"のように指定します |

  ![検索機能](https://user-images.githubusercontent.com/96732339/186201045-317001c9-462b-4db9-a282-5f0f869fa30f.gif)

## 非機能要件

- アクセス制御(cancancan)

  - 以下の機能はログイン中のみ利用可能

    - 非公開中の記事の表示
    - 公開中の記事が含まれないカテゴリーの表示
    - カテゴリー編集ページの表示
    - 記事編集ページの表示
    - マークダウンのプレビュー
    - 画像一覧の表示

  - 以下の機能は管理者のみ利用可能

    - カテゴリーの編集(作成、更新、削除)
    - 記事の編集(投稿、更新、削除)
    - 画像リソースの編集(投稿、削除)

- レスポンシブデザイン

  | 対象メディア   | ブレイクポイント |
  | -------------- | ---------------- |
  | PC             | 801px ～         |
  | タブレット     | 401px ～ 800px   |
  | スマートフォン | ～ 400px         |

- スラッグ(friendly_id)

- 常時 HTTPS 化(Certbot)

  - SSL 証明書の自動更新

- 例外処理

  | エラー                           | 処理                   |
  | -------------------------------- | ---------------------- |
  | 存在しないパスへのアクセス時     | 404 エラーページを表示 |
  | 存在しないリソースへのアクセス時 | 404 エラーページを表示 |
  | StandardError 発生時             | 500 エラーページを表示 |

- テストコード(RSpec)

  - 単体テスト(model spec、helper spec)
  - 機能テスト(request spec)
  - 統合テスト(feature spec)

- リンター

  - Ruby(RuboCop)
  - Javascript(ESLint)

- フォーマッター

  - Ruby(Rufo)
  - CSS、Sass、JavaScript、JSON(Prettier)
  - HTML、ERB(Format/Beautify ERB)

## データベース設計

![erd](https://user-images.githubusercontent.com/96732339/182565436-eae917a0-cf30-415e-8f59-d5dc424f0f30.svg)

## インフラ構成

![インフラ-AWS構成図-v2](https://user-images.githubusercontent.com/96732339/189619931-8d626b05-75e5-46e6-86d9-5ae5237ba8cc.svg)

## CI/CD

- 自動ビルド

  - GitHub への push または merge 時に、CircleCI 上でビルドが通ることを確認する。

- 自動テスト

  - 自動ビルドが成功した場合は、RuboCop、ESLint、RSpec をそれぞれ並列に実行する。

- 自動デプロイ

  - 全ての自動テストが成功し、master ブランチである場合は、EC2 へ自動デプロイする。
